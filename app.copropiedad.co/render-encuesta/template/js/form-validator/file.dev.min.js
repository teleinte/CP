(function(d,c){var e=typeof c.FileReader!="undefined",a=function(g){var f=d.split((g.valAttr("allowing")||"").toLowerCase());if(d.inArray("jpg",f)>-1&&d.inArray("jpeg",f)==-1){f.push("jpeg")}else{if(d.inArray("jpeg",f)>-1&&d.inArray("jpg",f)==-1){f.push("jpg")}}return f},b=function(f){if(c.console&&c.console.log){c.console.log(f)}};d.formUtils.addValidator({name:"mime",validatorFunction:function(i,k){var g=k.get(0).files||[];if(e){var f=true,h="",j=a(k);d.each(g,function(m,l){f=false;h=l.type||"";d.each(j,function(n,o){f=h.indexOf(o)>-1;if(f){return false}});return f});if(!f){b("Trying to upload a file with mime type "+h+" which is not allowed")}return f}else{b("FileReader not supported by browser, will check file extension");return d.formUtils.validators.validate_extension.validatorFunction(i,k)}},errorMessage:"The file you are trying to upload is of wrong type",errorMessageKey:"wrongFileType"});d.formUtils.addValidator({name:"extension",validatorFunction:function(h,i){var g=true,f=a(i);d.each(i.get(0).files||[],function(k,j){var m=j.value,l=m.substr(m.lastIndexOf(".")+1);if(d.inArray(l.toLowerCase(),f)==-1){g=false;return false}});return g},errorMessage:"The file you are trying to upload is of wrong type",errorMessageKey:"wrongFileType"});d.formUtils.addValidator({name:"size",validatorFunction:function(h,j){var i=j.valAttr("max-size");if(!i){b('Input "'+j.attr("name")+'" is missing data-validation-max-size attribute');return true}else{if(!e){return true}}var f=d.formUtils.convertSizeNameToBytes(i),g=true;d.each(j.get(0).files||[],function(l,k){g=k.size<=f;return g});return g},errorMessage:"The file you are trying to upload is too large",errorMessageKey:"wrongFileSize"});d.formUtils.convertSizeNameToBytes=function(f){f=f.toUpperCase();if(f.substr(f.length-1,1)=="M"){return parseInt(f.substr(0,f.length-1),10)*1024*1024}else{if(f.substr(f.length-2,2)=="MB"){return parseInt(f.substr(0,f.length-2),10)*1024*1024}else{if(f.substr(f.length-2,2)=="KB"){return parseInt(f.substr(0,f.length-2),10)*1024}else{if(f.substr(f.length-1,1)=="B"){return parseInt(f.substr(0,f.length-1),10)}else{return parseInt(f,10)}}}}};d(c).one("validatorsLoaded formValidationSetup",function(f,g){var h;if(g){h=g.find('input[type="file"]')}else{h=d('input[type="file"]')}h.filter("*[data-validation]").bind("change",function(){d(this).removeClass("error").parent().find(".form-error").remove()})})})(jQuery,window);